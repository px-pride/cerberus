# screenrc.claude - Screen configuration for the Claude process

# Keep the default Ctrl-A escape key for compatibility
# but also add alternative bindings
escape ^Aa

# Set a large scrollback buffer
defscrollback 10000

# Disable visual bell
vbell off

# Set the terminal type
term xterm-256color

# Display a status line at the bottom
hardstatus alwayslastline
hardstatus string '%{= kG}[ %{G}%H %{g}][%= %{= kw}%?%-Lw%?%{r}(%{W}%n*%f%t%?(%u)%?%{r})%{w}%?%+Lw%?%?%= %{g}][%{B} %d/%m %{W}%c %{g}]'

# Allow bold colors - necessary for some reason
attrcolor b ".I"

# Tell screen how to set colors. AB = background, AF=foreground
termcapinfo xterm 'Co#256:AB=\E[48;5;%dm:AF=\E[38;5;%dm'

# Enable 256 color term
term screen-256color

# Message displayed for 2 seconds when screen is started
startup_message off
msgwait 2
msgminwait 1
caption always "%{= kw}%-w%{= BW}%n %t%{-}%+w %-= @%H - %LD %d %LM - %c"

# Make Enter insert a newline instead of submitting
# In screen, we use literal ^M for Enter
bindkey -d "\015" stuff "\005\015"

# Ctrl+] for submission with phrase and terminating other processes
# Screen uses escape sequences for control characters
# We explicitly specify the full path to Python interpreter to avoid PATH issues
bindkey "^]" exec !!! /home/user/metaclaude/venv/bin/python3 -m metaclaude.core.command_client $STY "submit_to_claude_preprocessed"
bindkey "^[" exec !!! /home/user/metaclaude/venv/bin/python3 -m metaclaude.core.command_client $STY "submit_no_kill"

# Ctrl+r for full reloading the session (kills processes and reloads plugins, commands, and layout)
bindkey "^r" exec !!! /home/user/metaclaude/venv/bin/python3 -m metaclaude.core.command_client $STY "full_reload"

# Ctrl+\ for fully restarting the session (kills Claude CLI and all processes, then restarts everything)
bindkey "^\" exec !!! /home/user/metaclaude/venv/bin/python3 -m metaclaude.core.command_client $STY "restart"

# Prevent carriage return (Ctrl+m) from submitting
# This maps Ctrl+m to insert a literal newline
bindkey "^m" stuff "\005\015"

# Allow scrolling with mouse
termcapinfo xterm* ti@:te@

# Fix for terminal silliness
altscreen on
